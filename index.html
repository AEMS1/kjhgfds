<!DOCTYPE html>
<html>
<head>
  <title>Mini PancakeSwap</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <h1>Mini PancakeSwap - BNB â†” BUSD</h1>

  <button onclick="connectWallet()">ğŸ”— Ø§ØªØµØ§Ù„ Ø¨Ù‡ MetaMask</button>

  <div>
    <p>Ù…Ù‚Ø¯Ø§Ø± BNB:</p>
    <input type="text" id="bnbAmount" placeholder="Ù…Ø«Ù„Ø§Ù‹ 0.01">
  </div>

  <button onclick="swapBNBtoBUSD()">ğŸ”„ Ø³ÙˆØ§Ù¾ BNB Ø¨Ù‡ BUSD</button>

  <p id="status"></p>

  <script>
    const routerAddress = "0x10ED43C718714eb63d5aA57B78B54704E256024E"; // PancakeSwap Router V2
    const BUSD_ADDRESS = "0xe9e7cea3dedca5984780bafc599bd69add087d56"; // BUSD Token (BEP-20)

    const routerAbi = [
      "function swapExactETHForTokens(uint amountOutMin, address[] calldata path, address to, uint deadline) payable returns (uint[] memory amounts)"
    ];

    let provider, signer;

    async function connectWallet() {
      if (window.ethereum) {
        provider = new ethers.providers.Web3Provider(window.ethereum);
        await provider.send("eth_requestAccounts", []);
        signer = provider.getSigner();
        const address = await signer.getAddress();
        document.getElementById("status").innerText = "âœ… Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…ØªØµÙ„ Ø´Ø¯: " + address;
      } else {
        alert("MetaMask Ù†ØµØ¨ Ù†ÛŒØ³Øª.");
      }
    }

    async function swapBNBtoBUSD() {
      const amountInput = document.getElementById("bnbAmount").value;
      if (!amountInput) return alert("Ù„Ø·ÙØ§Ù‹ Ù…Ù‚Ø¯Ø§Ø± BNB ÙˆØ§Ø±Ø¯ Ú©Ù†");

      const router = new ethers.Contract(routerAddress, routerAbi, signer);
      const to = await signer.getAddress();
      const amountOutMin = 0; // Ø¨Ø¯ÙˆÙ† Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø­Ø¯Ø§Ù‚Ù„ Ø®Ø±ÙˆØ¬ÛŒ
      const path = [
        "0xBB4CdB9CBd36B01bD1cBaEBF2De08d9173bc095c", // WBNB
        BUSD_ADDRESS
      ];
      const deadline = Math.floor(Date.now() / 1000) + 60 * 10; // 10 Ø¯Ù‚ÛŒÙ‚Ù‡

      try {
        const tx = await router.swapExactETHForTokens(
          amountOutMin,
          path,
          to,
          deadline,
          { value: ethers.utils.parseEther(amountInput) }
        );

        document.getElementById("status").innerText = "â³ Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ù…Ø¹Ø§Ù…Ù„Ù‡... TX: " + tx.hash;
        await tx.wait();
        document.getElementById("status").innerText = "âœ… Ù…Ø¹Ø§Ù…Ù„Ù‡ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯! TX: " + tx.hash;
      } catch (err) {
        document.getElementById("status").innerText = "âŒ Ø®Ø·Ø§: " + err.message;
      }
    }
  </script>
</body>
</html>
